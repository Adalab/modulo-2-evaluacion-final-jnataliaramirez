"use strict";const seriesSection=document.querySelector(".js_series_section"),searchInput=document.querySelector(".js_search_input"),submit=document.querySelector(".js_button"),favouriteSection=document.querySelector(".js_favourite_section"),reset=document.querySelector(".js_reset");let dataShows=[],dataFavourites=[];function handlerSearch(e){let t=searchInput.value;fetch("http://api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{dataShows=[];for(const t of e){let e=t.show;dataShows.push(e)}renderSearch(),setInLocalStorage()}),e.preventDefault()}function renderSearch(){seriesSection.innerHTML="";let e="";for(const t of dataShows){let a=t.image,s=t.id;const n=document.createElement("article"),r=document.createElement("img"),i=document.createElement("h3");isFavourite(t)?(e="series__card--fav",n.classList.add(""+e)):e="",n.classList.add("series__card"),n.classList.add("js_series_card"),r.classList.add("js_img_serie"),r.classList.add("series__img"),i.classList.add("js_name_serie"),i.classList.add("series__title"),n.id=""+s;const o="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";if(null===a)r.src=""+o;else{let e=a.medium;r.src=""+e}let c=document.createTextNode(""+t.name);i.appendChild(c),n.appendChild(r),n.appendChild(i),seriesSection.appendChild(n)}listenerFav()}function handlerFav(e){let t=parseInt(e.currentTarget.id);const a=dataShows.find(e=>e.id===t),s=dataFavourites.findIndex(e=>t===parseInt(e.id));-1===s?dataFavourites.push(a):dataFavourites.splice(s,1),renderSearch(),favouriteSection.innerHTML="",renderFav(),setInLocalStorage()}function listenerFav(){const e=document.querySelectorAll(".js_series_card");for(const t of e)t.addEventListener("click",handlerFav)}function listenerItemFav(){const e=document.querySelectorAll(".js_favourite");for(const t of e)t.addEventListener("click",handlerFav)}function isFavourite(e){return void 0!==dataFavourites.find(t=>t.id===e.id)}function renderFav(){for(const e of dataFavourites){let t=e.image,a=e.id;const s=document.createElement("li"),n=document.createElement("h3"),r=document.createElement("img"),i=document.createElement("span");s.classList.add("favourite__li"),s.classList.add("js_favourite"),n.classList.add("favourite__name"),r.classList.add("favourite__img"),i.classList.add("favourite__close"),s.id=""+a;const o="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";if(null===t)r.src=""+o;else{let e=t.medium;r.src=""+e}let c=document.createTextNode(""+e.name);n.appendChild(c);let d=document.createTextNode("x");i.appendChild(d),s.appendChild(n),s.appendChild(r),s.appendChild(i),favouriteSection.appendChild(s)}listenerItemFav()}function setInLocalStorage(){const e=JSON.stringify(dataFavourites);localStorage.setItem("favourite",e)}function getLocalStorage(){const e=localStorage.getItem("favourite");if(null!==e){const t=JSON.parse(e);dataFavourites=t,renderFav()}}function handlerReset(){dataFavourites.splice(0,dataFavourites.length),renderSearch(),favouriteSection.innerHTML="",renderFav(),setInLocalStorage()}fetch("https://api.tvmaze.com/shows?page=1").then(e=>e.json()).then(e=>{e.slice(-18).map(e=>dataShows.push(e));renderSearch(),setInLocalStorage()}),submit.addEventListener("click",handlerSearch),getLocalStorage(),reset.addEventListener("click",handlerReset);